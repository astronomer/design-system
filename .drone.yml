pipeline:
  # run install
  install:
    image: node
    commands:
      - yarn install --silent
    when:
      event: push

  # run lint
  lint:
    image: node
    commands:
      - yarn lint
    when:
      event: push

  # jest
  test:
    image: node
    commands:
      - yarn test
    when:
      event: push

  # release
  release:
    image: node
    commands:
      # NOTE: is a dry run - update to "release" to go live & publish
      - yarn release-dry
    environment:
      GITHUB_TOKEN:
        from_secret: gh_token
      NPM_TOKEN:
        from_secret: npm_token
    when:
      event: push
      branch: [ master ]
